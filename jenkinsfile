pipeline {
    agent any
    environment {
        DOCKER_IMAGE_NAME = "onesbenrhaime/onesbenrhaime-4twin-g1-frontentachat"
        DOCKER_HUB_CREDENTIALS = 'docker'
        DOCKER_COMPOSE_VERSION = "1.29.2"
    }


    stages {
            stage('Checkout') {
               steps {
                    checkout scm
                }
            }
            stage('docker Build') {
                    steps {
                        sh 'docker build -t onesbenrhaime/onesbenrhaime-4twin-g1-frontentachat .'
                    }
                }
            stage('docker push') {
                    steps {
                        sh 'docker push onesbenrhaime/onesbenrhaime-4twin-g1-frontentachat'
                    }
                }


            stage('Run Docker Compose') {
                            steps {
                                script {
                                    // Perform Docker login if needed
                                     sh 'docker login -u onesbenrhaime -p 223AFT2892'
                                    // Pull the Docker images if needed
                                     sh 'docker compose pull'
                                    // Run Docker Compose
                                     sh 'docker compose up -d'
                                }
                            }
            }
    }
}